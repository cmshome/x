## 定位 Java 高 CPU 线程问题


top -H -p 597859  
    -H‌：启用线程模式，展示进程内各线程的独立运行状态（默认聚合进程级数据）‌。  
    -p 597859‌：指定目标进程 PID，仅显示该进程的信息‌  

1. ‌动态排序  
   * 按 P：根据 CPU 使用率降序排列线程‌   
   * 按 M：根据内存使用率降序排列‌
2. 若需定位 Java 高 CPU 线程问题：
   * 通过 top -H -p 597859 获取高 CPU 占用的十进制线程 ID（如 12345）。  
   * 转换为十六进制：printf "%x" 12345 → 3039  
   * 使用 jstack 597859 > stack.log 导出线程堆栈，搜索 nid=0x3039 定位代码位置‌
3. 导出数据  
   top -H -b -n 1 -p 597859 > threads.txt  
   使用 -b -n 1 以批处理模式输出一次结果  
4. 调整刷新频率  
   启动时添加 -d 2（如 top -H -d 2 -p 597859）设定 2 秒更新一次‌

